<!DOCTYPE html>
<html>
<head>
  <title>Recipe</title>
  <style>
    body {
      margin: 0;
      font-family: 'Courier New', monospace;
      display: flex;
      background-image: url('https://i.pinimg.com/1200x/0c/1a/36/0c1a3645a6569e802edf98f725b12f78.jpg');
    }

    #sidebar-container {
      width: 25%;
    }

    .main-content {
      flex-grow: 1;
      padding: 40px;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 40px;
    }

    .top-bar h1 {
      font-size: 45px;
    }

    .top-bar .search-bar {
      display: flex;
      gap: 10px;
    }

    .search-bar input, .search-bar button {
      padding: 8px;
      font-size: 16px;
    }

    input[type="text"], textarea {
      padding: 10px;
      font-size: 16px;
      border-radius: 10px; 
      border: 1px solid #cccccc;
      outline: none;
      width: 500px;
      margin-bottom: 10px;
    }

    button {
      padding: 10px 15px;
      font-size: 16px;
      border-radius: 30px;
      border: none;
      background-color: #464e8e;
      color: white;
      cursor: pointer;
      width: 150px;
    }

    button:hover {
      opacity: 0.8;
    }

    .recipe-section {
      background-color: #ffffffdd;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      cursor: pointer;
      transition: background 0.3s, border 0.3s;
    }

    .recipe-header {
      font-size: 26px;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .recipe-image {
      width: 100%;
      max-width: 400px;
      height: auto;
      border-radius: 8px;
      margin: 10px 0;
    }

    .recipe-details {
      display: none;
      padding-left: 20px;
      margin-top: 10px;
    }

    .recipe-details ul, .recipe-details ol {
      padding-left: 20px;
    }

    .recipe-section.active .recipe-details {
      display: block;
    }

    .modal-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 10px;
      width: 500px;
    }

    .modal-buttons {
      text-align: right;
      margin-top: 15px;
    }

    .modal-buttons button {
      margin-left: 10px;
    }

    .recipe-section.selected {
      border: 3px solid red;
      background-color: #ffecec;
    }

    #deleteControls {
      display: none;
      text-align: center;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div id="sidebar-container"></div>

  <div class="main-content">
    <div class="top-bar">
      <h1 style="text-align: center;">Recipes</h1>
      <div class="search-bar">
        <input type="text" placeholder="Search recipe">
        <button onclick="openAddRecipeModal()">Create recipe</button>
        <button onclick="enterDeleteMode()">Remove recipe</button>
      </div>
    </div>

    <div id="recipeList">
      <p style="text-align: center; font-weight: bold; font-size: 20px;">Added recipes appear here!</p>
    </div>

    <div id="deleteControls">
      <button onclick="deleteSelectedRecipe()" style="background:red; color:white;">Delete</button>
      <button onclick="exitDeleteMode()" style="background:gray; color:white;">Done</button>
    </div>
  </div>

  <div id="recipeModal" class="modal-overlay">
    <div class="modal-content">
      <h2 style="text-align:center;">Add New Recipe</h2>

      <label>Recipe Name:</label>
      <input type="text" id="recipeName">

      <label>Image URL:</label>
      <input type="text" id="recipeImage">

      <label>Ingredients (comma separated):</label>
      <input type="text" id="recipeIngredients">

      <label>Utensils (comma separated):</label>
      <input type="text" id="recipeUtensils">

      <label>Steps (one per line):</label>
      <textarea id="recipeSteps" rows="4"></textarea>

      <div class="modal-buttons">
        <button onclick="closeAddRecipeModal()" style="background:#ccc;">Cancel</button>
        <button onclick="addRecipe()">Add Recipe</button>
      </div>
    </div>
  </div>

  

  <script>
    let deleteMode = false;

    function toggleRecipe(el) {
      if (!deleteMode) {
        el.classList.toggle('active');
      } else {
        const selected = document.querySelector('.recipe-section.selected');
        if (selected && selected !== el) selected.classList.remove('selected');
        el.classList.toggle('selected');
      }
    }

    function openAddRecipeModal() {
      document.getElementById('recipeModal').style.display = 'flex';
    }

    function closeAddRecipeModal() {
      document.getElementById('recipeModal').style.display = 'none';
    }

    function addRecipe() {
      const name = document.getElementById('recipeName').value.trim();
      const image = document.getElementById('recipeImage').value.trim();
      const ingredients = document.getElementById('recipeIngredients').value.split(',').map(i => i.trim()).filter(i => i);
      const utensils = document.getElementById('recipeUtensils').value.split(',').map(i => i.trim()).filter(i => i);
      const steps = document.getElementById('recipeSteps').value.split('\n').map(s => s.trim()).filter(s => s);

      if (!name || !image || ingredients.length === 0 || steps.length === 0) {
        return alert("Please fill in all fields.");
      }

      const section = document.createElement('div');
      section.className = 'recipe-section';
      section.onclick = function () { toggleRecipe(this); };
      section.innerHTML = `
        <div class="recipe-header">${name}</div>
        <div class="recipe-details">
          <img src="${image}" class="recipe-image" alt="${name}">
          <p><strong>Ingredients:</strong></p>
          <ul>${ingredients.map(i => `<li>${i}</li>`).join('')}</ul>
          <p><strong>Utensils:</strong></p>
          <ul>${utensils.map(i => `<li>${i}</li>`).join('')}</ul>
          <p><strong>Steps:</strong></p>
          <ol>${steps.map(s => `<li>${s}</li>`).join('')}</ol>
        </div>
      `;

      document.getElementById('recipeList').appendChild(section);
      saveRecipesToStorage();

      document.getElementById('recipeName').value = '';
      document.getElementById('recipeImage').value = '';
      document.getElementById('recipeIngredients').value = '';
      document.getElementById('recipeUtensils').value = '';
      document.getElementById('recipeSteps').value = '';

      closeAddRecipeModal();
    }

    function enterDeleteMode() {
      deleteMode = true;
      document.getElementById('deleteControls').style.display = 'block';
    }

    function deleteSelectedRecipe() {
      const selected = document.querySelector('.recipe-section.selected');
      if (selected) {
        if (confirm('Are you sure you want to delete this recipe?')) {
          selected.remove();
        }
      } else {
        alert("Please select a recipe to delete.");
      }
    }

    function exitDeleteMode() {
      deleteMode = false;
      document.getElementById('deleteControls').style.display = 'none';
      document.querySelectorAll('.recipe-section').forEach(section => {
        section.classList.remove('selected');
      });
    }

    function saveRecipesToStorage() {
  const allRecipes = [];
  document.querySelectorAll('.recipe-section').forEach(section => {
    const name = section.querySelector('.recipe-header').innerText;
    const img = section.querySelector('.recipe-image').src;
    const ingredients = Array.from(section.querySelectorAll('ul:nth-of-type(1) li')).map(li => li.innerText);
    const utensils = Array.from(section.querySelectorAll('ul:nth-of-type(2) li')).map(li => li.innerText);
    const steps = Array.from(section.querySelectorAll('ol li')).map(li => li.innerText);

    allRecipes.push({ name, img, ingredients, utensils, steps });
  });

  localStorage.setItem('savedRecipes', JSON.stringify(allRecipes));
}

    fetch('sidebar.html')
  .then(response => response.text())
  .then(data => {
    const container = document.getElementById('sidebar-container');
    container.innerHTML = data;

    const scripts = container.querySelectorAll("script");
    scripts.forEach(script => {
      eval(script.innerText);
    });
  });

  function loadRecipesFromStorage() {
  const data = localStorage.getItem('savedRecipes');
  if (!data) return;

  const recipes = JSON.parse(data);
  recipes.forEach(({ name, img, ingredients, utensils, steps }) => {
    const section = document.createElement('div');
    section.className = 'recipe-section';
    section.onclick = function () { toggleRecipe(this); };
    section.innerHTML = `
      <div class="recipe-header">${name}</div>
      <div class="recipe-details">
        <img src="${img}" class="recipe-image" alt="${name}">
        <p><strong>Ingredients:</strong></p>
        <ul>${ingredients.map(i => `<li>${i}</li>`).join('')}</ul>
        <p><strong>Utensils:</strong></p>
        <ul>${utensils.map(i => `<li>${i}</li>`).join('')}</ul>
        <p><strong>Steps:</strong></p>
        <ol>${steps.map(s => `<li>${s}</li>`).join('')}</ol>
      </div>
    `;
    document.getElementById('recipeList').appendChild(section);
  });
}

loadRecipesFromStorage();

  </script>
</body>
</html>
